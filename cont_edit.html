<!doctype html>
<html lang="tr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Düzenlenebilir Kart (Yerel Resim Yükleme)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  </head>
  <body class="bg-light py-5">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-md-6">

          <!-- KART -->
          <div class="card shadow-sm mb-4">
            <img id="cardImage" src="" class="card-img-top" alt="Kart Görseli">
            <div class="card-body">
              <h5 id="cardTitle" class="card-title">Kart Başlığı</h5>
              <p id="cardText" class="card-text">Bu, kart açıklamasıdır. Burada kartla ilgili kısa bir bilgi yer alır.</p>
            </div>
          </div>

          <!-- DÜZENLEME FORMU -->
          <div class="card p-3 shadow-sm">
            <h5 class="mb-3">Kartı Düzenle</h5>
            <form id="editForm">
              <div class="mb-3">
                <label for="imageFile" class="form-label">Yeni Resim Yükle</label>
                <input type="file" class="form-control" id="imageFile" accept="image/*">
              </div>

              <div class="mb-3">
                <label for="titleInput" class="form-label">Başlık</label>
                <input type="text" class="form-control" id="titleInput" placeholder="Yeni başlık girin...">
              </div>

              <div class="mb-3">
                <label for="textInput" class="form-label">Açıklama</label>
                <textarea class="form-control" id="textInput" rows="3" placeholder="Yeni açıklama girin..."></textarea>
              </div>
              <div style="display: flex;">
                <button type="button" class="btn btn-primary w-50" id="updateBtn">Güncelle</button>
                <button type="button" class="btn btn-success w-50" id="updateBtn">Kaydet</button>
              </div>
            </form>
          </div>

        </div>
      </div>
    </div>

    <script>
      const updateBtn = document.getElementById('updateBtn');

      updateBtn.addEventListener('click', () => {
        const title = document.getElementById('titleInput').value;
        const text = document.getElementById('textInput').value;
        const fileInput = document.getElementById('imageFile');
        const imageElement = document.getElementById('cardImage');

        // Başlık ve açıklama güncelle
        if (title) document.getElementById('cardTitle').textContent = title;
        if (text) document.getElementById('cardText').textContent = text;

        // Resim dosyası seçildiyse önizleme olarak kartta göster
        if (fileInput.files && fileInput.files[0]) {
          const reader = new FileReader();
          reader.onload = function(e) {
            imageElement.src = e.target.result;
          };
          reader.readAsDataURL(fileInput.files[0]);
        }
      });
    </script>
    <script>
      async function loadLink() {
  try {
    const response = await fetch('/.netlify/functions/getData');
    if (!response.ok) throw new Error('Veri çekilemedi');

    const cards = await response.json();

    const params = new URLSearchParams(window.location.search);
    const ids = parseInt(params.get("id"));
    // Örnek: sadece ilk veriyi alıyoruz
    const firstCard = cards.find(card => card.id === ids);

    const imagecard = document.getElementById('cardImage');
    imagecard.src = firstCard.photo_url;   // Linkin görünen metni

    const titlecard = document.getElementById('cardTitle');
    titlecard.textContent = firstCard.title; 

    const textcard = document.getElementById('cardText');
    textcard.textContent = firstCard.example; 

  } catch (error) {
    console.error('Error fetching data:', error);
  }
}

loadLink();
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
